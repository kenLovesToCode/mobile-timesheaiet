# Epic 1 Retrospective - Foundations and Local-First Setup

Date: 2026-02-25
Project: priceTag
Epic: 1 - Foundations and Local-First Setup
Retrospective Type: Epic completion review (auto-facilitated from implementation artifacts)

## Scope and Inputs Reviewed

- Sprint tracking: `_bmad-output/implementation-artifacts/sprint-status.yaml`
- Story records: `1-1` through `1-5` implementation artifacts
- Planning context: `_bmad-output/planning-artifacts/epics.md`, `prd.md`, `architecture.md`
- Agent context: `_bmad/_config/agent-manifest.csv`

## Epic Completion Verification

Epic 1 story statuses in `sprint-status.yaml` on review:

- `1-1-base-app-initialization-and-configuration`: `done`
- `1-2-local-database-setup-sqlite-drizzle-zod`: `done`
- `1-3-core-packages-and-permissions-setup`: `done`
- `1-4-app-shell-and-navigation-scaffold`: `done`
- `1-5-ui-system-setup-theme-tokens-base-components`: `done`

Result:

- Stories completed: 5/5
- Epic completion by story status: complete
- Note: `epic-1` tracker key is still `in-progress`; this is a tracker hygiene mismatch and should be reconciled separately.

## Participants (Retrospective Context)

- sensei (Project Lead)
- Bob (Scrum Master) - facilitation role
- Amelia / Dev agent (implementation)
- QA role (review/test evidence and smoke checks)
- Winston / Architect role (architecture guardrails)
- John / Product role (Epic 2 readiness and scope continuity)

## What Went Well

- Foundation scope was correctly sequenced: app bootstrap, DB stack, device permissions, navigation shell, then UI system.
- Strong offline-first groundwork is now in place (SQLite + Drizzle + migrations + Zod validation) before feature stories.
- Cross-platform safety patterns improved during execution:
  - Native/web split bootstrap and platform-specific modules prevented export regressions.
  - Dev-only tooling isolation improved to avoid production route/bundle leakage.
- Navigation shell quality improved beyond the initial scope with smoke coverage and runtime evidence artifacts.
- UI system foundations (tokens/themes/primitives) were implemented before feature-heavy Epic 2 work, reducing upcoming UI churn.
- User-provided runtime evidence closed several native validation gaps that could not be reproduced in the sandbox.

## Challenges and Friction

- Evidence rigor and documentation drift created repeated review churn, especially around:
  - overstated validation claims,
  - file-list accuracy,
  - sprint-status sync claims,
  - runtime evidence traceability.
- Native runtime validation was frequently blocked in the local environment, forcing attestation-based evidence for some acceptance criteria.
- Preview/RC dependency stack introduced warning noise and increased caution around versioning and claims.
- Dev tooling routes required more work than expected to keep them isolated from production route graphs and bundles.
- Story 1.4 review cycles became disproportionately heavy relative to scaffold complexity.

## Cross-Story Patterns (Observed)

### Common Struggles

- Review artifact accuracy and evidence wording were recurring issues across multiple stories.
- Cross-platform import boundaries (native vs web) repeatedly surfaced as a reliability concern.
- "Dev-only" functionality needed explicit architectural isolation, not just runtime guards.

### Recurring Review Feedback Themes

- Do not over-claim runtime validation from static checks.
- Keep file-impact evidence aligned to the actual git diff for the current cycle.
- Preserve production behavior while adding internal smoke/debug tools.
- Accessibility semantics and minimum touch targets need explicit validation, not assumptions.

### Breakthrough Moments

- Story 1.2: Native-only DB bootstrap gate pattern kept web exports healthy while enforcing native migration gating.
- Story 1.4: Production-router export strategy plus bundle inspection established a stronger pattern for excluding dev routes from production bundles.
- Story 1.4/1.5: Focused automated smoke tests (navigation + UI primitives) improved regression confidence for foundation work.

## Technical Debt and Carry-Forward Risks

- `@tamagui/native/setup-zeego` non-fatal warning still appears in some native export/build flows (known noise, not a blocker, but worth tracking).
- Some acceptance evidence remains user-attested rather than reviewer-captured runtime artifacts.
- Tracker hygiene mismatch: Epic stories are complete while `epic-1` remains `in-progress`.
- Review-process overhead is high for artifact-heavy stories and can slow feature throughput if unchanged.

## Key Lessons Learned

1. Treat evidence collection as part of implementation, not a cleanup task after coding.
2. Native/web platform boundaries should be designed early for Expo foundation work.
3. Dev-only tooling must be excluded from production route graphs at build-time, not only guarded at runtime.
4. Foundation epics benefit from lightweight smoke tests to prevent repeated regressions during review cycles.
5. Precise artifact bookkeeping (file lists, status claims, evidence wording) materially reduces review churn.

## Previous Retrospective Follow-Through

- Not applicable. This is the first retrospective for the project (Epic 1).

## Epic 2 Preview (Next Epic Preparation)

Next epic identified from planning artifacts:

- Epic 2 - Instant Price Lookup and Contribution Loop

Planned stories:

- 2.1 Store setup and active gating
- 2.2 Add or edit price and product info
- 2.3 Results view for active stores
- 2.4 Scan flow with haptics and torch
- 2.5 Manual-entry + recent-scans fallback
- 2.6 Permission denied + empty states
- 2.7 Non-blocking flow behavior

### Dependencies on Epic 1 (Ready)

- App shell routes and safe-area scaffold
- UI token/theme system and base primitives
- Camera permission + haptics package/config setup
- Local DB foundation with migrations + validation

### Preparation Gaps Before/During Epic 2

- Expand DB schema from smoke/demo shape to MVP entities: stores, products, prices, recent scans, shopping list.
- Define repository/service boundaries for results lookup and price writes.
- Establish feature-level state patterns (Zustand usage boundaries) for scan/results/add-price flows.
- Add stronger runtime test/evidence plan for camera, scan, results updates, and permission-denied paths.
- Define data freshness/timestamp formatting conventions for Results rows (trust signal in PRD).

## Significant Discovery Check (Epic Plan Impact)

Conclusion: No fundamental Epic 2 rewrite is required.

What should change:

- Add explicit implementation guardrails for evidence capture and platform/runtime validation in Epic 2 stories.
- Treat dev-tooling route isolation and production bundle checks as a reusable pattern when adding future internal debug routes.
- Track known build-warning noise separately so it does not distort feature-story review outcomes.

## Action Plan (Owned, Specific, No-Blame)

### Process Improvements

1. Add a standard evidence checklist section template to future story artifacts before implementation starts.
   - Owner: Bob (Scrum Master) + sensei
   - Milestone: Before starting Story 2.1
   - Success criteria: New Epic 2 story artifacts include an evidence checklist (commands, runtime proof, artifact paths, claim wording rules).

2. Add a "claim vs evidence" final review pass step for story artifact updates.
   - Owner: Amelia (Dev) + QA role
   - Milestone: Starting with Story 2.1 review cycle
   - Success criteria: Review findings for file-list drift / overstated validation claims are reduced.

### Technical Debt / Stability

3. Create a tracked issue for the intermittent `setup-zeego` native export warning and document current observed behavior + non-blocking status.
   - Owner: Amelia (Dev)
   - Milestone: Before Story 2.4 runtime validation
   - Success criteria: Warning is documented with reproduction notes, impact statement, and decision (fix now / defer).

4. Reconcile sprint tracker state for Epic 1 (`epic-1`) with story completion status.
   - Owner: Bob (Scrum Master)
   - Milestone: Before Epic 2 is marked `in-progress` by story creation workflow activity
   - Success criteria: Epic-level tracker state matches actual story completion state.

### Testing / Validation Readiness

5. Define an Epic 2 runtime evidence plan for scan and results flows (device targets, routes, proof artifacts, what counts as acceptable evidence).
   - Owner: QA role + sensei
   - Milestone: Before Story 2.4 and Story 2.3 completion claims
   - Success criteria: Story acceptance claims reference durable evidence artifacts instead of ad hoc logs where possible.

## Critical Path Before Deep Epic 2 Scan Work

- DB schema expansion is ready for stores/products/prices/recent scans.
- Runtime evidence plan is defined for scan/haptics/torch/permission-denied scenarios.
- Tracker hygiene is reconciled for Epic 1 closure.
- Known warning noise is documented so review focus stays on real regressions.

## Readiness Assessment (Epic 1 "Really Done?" Check)

### Story-Completion Readiness

- Status: Yes, from a story-tracking perspective (5/5 Epic 1 stories are `done`).

### Product/Release Readiness

- Status: Not applicable for production release.
- Reason: Epic 1 is a foundation epic; it establishes infrastructure and UI scaffolding, not end-user MVP feature completion.

### Technical Health

- Status: Good foundation with known caveats
- Caveats:
  - Some runtime evidence is attestation-based
  - Known non-fatal native export warning noise
  - High review-process overhead on artifact-intensive stories

### Go/No-Go for Epic 2

- Go, with the action items above treated as readiness guardrails.

## Commitments for Next Epic

- Preserve evidence rigor and artifact accuracy as first-class deliverables.
- Reuse the native/web split and dev-route isolation patterns instead of rediscovering them.
- Keep UI primitives and tokens as the default path for new feature screens.
- Prioritize durable runtime evidence for scan/results flows to reduce review churn.

## Retrospective Outcome

- Epic 1 retrospective complete
- Epic 2 plan remains valid
- Improvements identified in process, evidence handling, and tracker hygiene
- Team is positioned to start Epic 2 with a stronger implementation/review loop
